# CVE-2025-XXXX - Free Download Manager Mark-of-the-Web (MoTW) Bypass Leading to Execution

## Vulnerability Overview
A critical vulnerability has been identified in **Free Download Manager 6.19.0.5156** for Windows, in which downloaded files **do not retain the Mark-of-the-Web (MoTW)** alternate data stream. This causes Windows to treat such files as trusted, **bypassing SmartScreen protections and other MoTW-dependent defenses**, allowing execution of malicious content without user warnings.

## Vulnerability Description
When a file is downloaded via a modern browser (e.g., Chrome or Edge), it is tagged with a **Zone.Identifier** stream — known as **Mark-of-the-Web (MoTW)** — which causes Windows and Microsoft Defender to treat the file as untrusted. This enables protections such as:

- Blocking or warning on execution (SmartScreen)
- Office macro blocking
- Defender behavior-based detections

**Free Download Manager bypasses this mechanism entirely.** Files downloaded through Free Download Manager do not carry the MoTW, and are **treated as local, trusted files** — causing **Windows security mechanisms to be bypassed silently**.

## Impact
A file downloaded using Free Download Manager will execute **without triggering SmartScreen** or other MoTW-based defenses. This can lead to:

- **Silent code execution**
- **Credential theft or registry hive dumping**
- **Complete bypass of Microsoft Defender’s protection model**

### **What Happened**

- **Blocked by SmartScreen**: When downloaded via **Chrome**, **SmartScreen** blocked the `.bat` file.
- **Executed Immediately via Free Download Manager**: When downloaded via **Free Download Manager**, the file executed immediately and attempted to dump registry hives (`HKLM\SAM`).
- **No SmartScreen Warning**: The file downloaded via Free Download Manager **did not trigger SmartScreen**, demonstrating that it was trusted by the system, as the MoTW flag was absent.

## **Affected Products**

- **Product**: Free Download Manager
- **Version(s) Affected**: **6.19.0.5156** (latest at the time of discovery)
- **Patched Version(s)**: _None at the time of discovery_

## **CVSS (Proposed)**

- **Base Score**: **8.6** (High)
- **Vector String**:  
  `CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N`
- **Attack Vector**: **Network (file download)**
- **Privileges Required**: **None**
- **User Interaction**: **Required** (user runs file)
- **Impact**: **Code Execution**, **Credential Access**

## **Exploitation Flow**

1. Attacker hosts `.bat` payload on server.
2. Victim downloads the payload via **Free Download Manager** (no MoTW).
3. The file is run — no SmartScreen warning is shown.
4. **Registry dump** is attempted (`reg save HKLM\SAM C:\securitybypass.save`).

## **Discoverer**

**Enis Aksu**  
[GitHub](https://github.com/EnisAksu)  
[LinkedIn](https://www.linkedin.com/in/EnisAksu)

## **References**

- [Mark-of-the-Web - Microsoft Docs](https://learn.microsoft.com/en-us/windows/security/threat-protection/windows-defender-smartscreen/windows-defender-smartscreen-overview)
- [ATT&CK T1564.004 – NTFS File Attributes](https://attack.mitre.org/techniques/T1564/004/)