# CVE-2025-33026 - PeaZip Mark-of-the-Web Bypass Vulnerability

## Vulnerability Overview
A **Mark-of-the-Web (MotW) Bypass Vulnerability** has been discovered in **PeaZip** (up to version 10.4.0) which allows attackers to bypass the Mark-of-the-Web protection mechanism. This flaw allows extracted files from a malicious archive to lose the MotW tag, making the system treat them as local files, thereby bypassing any security warnings that would normally prevent execution of potentially harmful files.

## Vulnerability Description
PeaZip does not propagate the Mark-of-the-Web protection to the extracted files when opening an archive that has been downloaded from the internet. As a result, files such as macro-enabled Office documents or executable scripts are treated as trusted files and can be executed without triggering security alerts such as SmartScreen or Defender.

## Exploitation Chain
1. The attacker crafts a malicious archive (e.g., `.zip` or `.7z`) containing a file (e.g., `.docm`).
2. The archive is downloaded from the internet, thus tagged with the **Mark-of-the-Web (MotW)**.
3. The archive is opened with PeaZip, which extracts the contents.
4. The **MotW is stripped** from the extracted files, allowing them to be trusted and executed.
5. As a result, any embedded malicious code (e.g., macro) can be executed by the user without any security warnings.

## CVSS Score
**CVSS v3.0 Score**: **7.8 - High**
- **Attack Vector**: Local
- **Complexity**: Low
- **Privileges Required**: None
- **User Interaction**: Required (the target must open the malicious archive)

## Affected Products
- **PeaZip** versions **10.4.0** (Windows 64-bit)
- There is **no fixed version** available as of now.

## Impact
- **Code execution**: Malicious scripts or executables can be executed on the user's system.
- **Escalation of Privileges**: Attackers can gain control in the context of the current user.
- **Information Disclosure**: Sensitive information may be exposed due to executed code.

## Exploitation Example
1. Create or download a macro-enabled `.docm` file from the internet.
2. Compress the file into a `.zip` archive.
3. Extract the `.zip` archive using **PeaZip**.
4. The extracted `.docm` file will **not** have the MotW and will be treated as a local file, allowing macros to execute without warning.

## Discoverer
**Enis Aksu**  
[GitHub](https://github.com/EnisAksu)  
[LinkedIn](https://www.linkedin.com/in/EnisAksu/)

## References
- [PeaZip Website](https://peazip.github.io/peazip-64bit.html)
- [MITRE CVE-2025-33026](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-33026)

## CVE ID
- CVE-2025-33026